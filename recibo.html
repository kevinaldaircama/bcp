<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Enviar a</title>
<link rel="manifest" href="manifest.json" />
<meta name="theme-color" content="#01256f" />
<link rel="icon" type="images/png" href="images/app_icon_xxxhdpi.png"> 

<style>
  body {margin:0;font-family:'Roboto',sans-serif;background:#fff;color:#000;}
  .header{background:#0046BE;color:white;display:flex;align-items:center;justify-content:space-between;padding:12px 16px;font-size:18px;font-weight:500;}
  .header span{font-size:18px;cursor:pointer;}
  .container{padding:20px;}
  .profile{text-align:center;margin-top:10px;}
  .profile .circle{background:#2A6FF5;color:white;width:55px;height:55px;border-radius:50%;display:flex;justify-content:center;align-items:center;margin:0 auto 10px;font-size:22px;font-weight:bold;}
  .profile h2{margin:0;font-size:18px;}
  .profile p{margin:4px 0;color:#777;font-size:14px;}
  hr{border:none;border-top:1px solid #ddd;margin:20px 0;}
  .section-title{color:#0046BE;font-weight:500;margin-bottom:8px;font-size:15px;}
  .currency-toggle{display:flex;gap:8px;margin-bottom:10px;}
  .currency-toggle button{flex:1;padding:8px;border-radius:20px;border:1px solid #ccc;background:#f3f3f3;font-size:16px;color:#777;cursor:pointer;}
  .currency-toggle button.active{background:#E7EEF9;color:#0046BE;border-color:#0046BE;}
  .amount{font-size:42px;color:#0046BE;font-weight:500;display:flex;align-items:center;gap:6px;}
  .amount input{border:none;outline:none;font-size:42px;color:#444;width:150px;text-align:left;}
  .account-card{border:1px solid #ddd;border-radius:12px;padding:14px;margin-top:10px;display:flex;justify-content:space-between;align-items:center;}
  .account-info{font-size:14px;}
  .account-info strong{display:block;color:#000;font-size:15px;}
  .account-info span{color:#777;}
  .account-balance{color:#0046BE;font-weight:500;}
  .btn{margin:40px auto 10px;display:block;width:90%;max-width:400px;padding:12px;border:none;border-radius:30px;background:#d6d6d6;color:white;font-size:16px;cursor:not-allowed;transition:background .3s;}
  .btn.active{background:#0046BE;cursor:pointer;}

  /* Modal de carga */
  .loading-modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.85);justify-content:center;align-items:center;z-index:9999;}
  .loader-container{position:relative;width:120px;height:120px;}
  .loader-circle{position:absolute;top:0;left:0;width:120px;height:120px;border:6px solid transparent;border-top:6px solid #ff6600;border-radius:50%;animation:spin 1.2s linear infinite;}
  .loader-logo{position:absolute;top:50%;left:50%;width:70px;height:70px;transform:translate(-50%,-50%);}
  @keyframes spin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}
</style>
</head>
<body>

<div class="header">
  <span onclick="window.history.back()">&larr;</span>
  <span>Enviar a</span>
  <span></span>
</div>

<div class="container">
  <div class="profile">
    <div class="circle" id="circle">?</div>
    <h2 id="nombre">---</h2>
    <p id="numero">---</p>
  </div>

  <hr>

  <div>
    <div class="section-title">Moneda y monto</div>
    <div class="currency-toggle">
      <button class="active">S/</button>
      <button>$</button>
    </div>
    <div class="amount">
      <span>S/</span>
      <input type="text" value="0.00" id="montoInput">
    </div>
  </div>

  <div style="margin-top:30px;">
    <div class="section-title">Desde</div>
    <div class="account-card">
      <div class="account-info">
        <strong>Cuenta Digital Soles</strong>
        <span id="origenCuenta">****1234</span>
      </div>
      <div class="account-balance" id="saldoCuenta">S/ 0.00</div>
    </div>
  </div>

  <button class="btn" id="continuarBtn">Continuar</button>
</div>

<!-- Modal de carga -->
<div class="loading-modal" id="loadingModal">
  <div class="loader-container">
    <div class="loader-circle"></div>
    <img src="images/lg_favicon_light.svg" class="loader-logo" alt="Logo">
  </div>
</div>

<script>
  const nombreElem = document.getElementById("nombre");
  const numeroElem = document.getElementById("numero");
  const circle = document.getElementById("circle");
  const montoInput = document.getElementById("montoInput");
  const continuarBtn = document.getElementById("continuarBtn");
  const origenCuentaElem = document.getElementById("origenCuenta");
  const saldoCuentaElem = document.getElementById("saldoCuenta");
  const loadingModal = document.getElementById("loadingModal");

  // Recuperar datos del almacenamiento
  const empresa = localStorage.getItem("servicio") || "EMPRESA S.A.";
  const codigoServicio = localStorage.getItem("codigoServicio") || "1234";
  const origenGuardado = localStorage.getItem("origen");
  const saldoGuardado = localStorage.getItem("saldo") || "0.00";

  // Mostrar datos
  nombreElem.textContent = empresa;
  numeroElem.textContent = codigoServicio;
  circle.textContent = empresa.charAt(0).toUpperCase();
  origenCuentaElem.textContent = origenGuardado ? "****" + origenGuardado.slice(-4) : "****1234";
  saldoCuentaElem.textContent = `S/ ${parseFloat(saldoGuardado).toFixed(2)}`;

  // Mostrar 0.00 y borrarlo al enfocar
  montoInput.value = "0.00";
  montoInput.addEventListener("focus", () => {
    if (montoInput.value === "0.00") montoInput.value = "";
  });
  montoInput.addEventListener("blur", () => {
    if (montoInput.value.trim() === "") montoInput.value = "0.00";
  });

  // Activar botón si monto válido
  montoInput.addEventListener("input", () => {
    const valor = parseFloat(montoInput.value);
    if (!isNaN(valor) && valor > 0) {
      continuarBtn.classList.add("active");
      continuarBtn.disabled = false;
    } else {
      continuarBtn.classList.remove("active");
      continuarBtn.disabled = true;
    }
  });

  // Redirigir a confirmación y guardar datos
  continuarBtn.addEventListener("click", () => {
    const monto = parseFloat(montoInput.value);
    if (isNaN(monto) || monto <= 0) return;

    // Guardar datos para la página de confirmación
    localStorage.setItem("nombreEmpresa", empresa);
    localStorage.setItem("nombreServicio", empresa); // o el nombre real del servicio
    localStorage.setItem("codigoServicio", codigoServicio);
    localStorage.setItem("titularCuenta", "Usuario Principal");
    localStorage.setItem("origen", origenGuardado || "0000");
    localStorage.setItem("montoTransferencia", monto.toFixed(2));

    // Mostrar modal de carga
    loadingModal.style.display = "flex";

    setTimeout(() => {
      loadingModal.style.display = "none";
      window.location.href = "servicio";
    }, 1000);
  });
</script>

</body>
</html>
